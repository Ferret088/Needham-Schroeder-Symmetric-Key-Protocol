\hypertarget{ns___a_p_i_8h}{\section{ns\-\_\-\-A\-P\-I.\-h File Reference}
\label{ns___a_p_i_8h}\index{ns\-\_\-\-A\-P\-I.\-h@{ns\-\_\-\-A\-P\-I.\-h}}
}


An easy to use A\-P\-I of Needham-\/\-Schroeder Protocol\-:\par
A-\/$>$S\-: A,B,Na\par
S-\/$>$A\-: \{Na, Kab, B, \{Kab, A, T\}Kbs\}Kas\par
A-\/$>$B\-: \{Kab, A, T\}Kbs\par
B-\/$>$A\-: \{Nb\}Kab\par
A-\/$>$B\-: \{Nb-\/1\}Kab\par
.  


\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{ns___a_p_i_8h_aafc60d71968489d9e2a8c3267d45eb54}{ns\-\_\-setup\-\_\-client\-\_\-default} ()
\begin{DoxyCompactList}\small\item\em Setup the Client process. Bind to the default port. Use default encryption. \end{DoxyCompactList}\item 
int \hyperlink{ns___a_p_i_8h_a25ce4c01964503c63e49af8a58e68712}{ns\-\_\-setup\-\_\-client} (int port, int encryption)
\begin{DoxyCompactList}\small\item\em Setup the Client process. Bind the port. etc. \end{DoxyCompactList}\item 
int \hyperlink{ns___a_p_i_8h_a430758755f7b099f8dce341d3ae5493a}{ns\-\_\-client\-\_\-negotiate\-\_\-keys} (char $\ast$server\-\_\-address, char $\ast$partner\-\_\-address)
\begin{DoxyCompactList}\small\item\em Initiate the key negotiation. by client.\par
A-\/$>$S\-: A,B,Na\par
S-\/$>$A\-: \{Na, Kab, B, \{Kab, A, T\}Kbs\}Kas\par
A-\/$>$B\-: \{Kab, A, T\}Kbs\par
B-\/$>$A\-: \{Nb\}Kab\par
A-\/$>$B\-: \{Nb-\/1\}Kab\par
. \end{DoxyCompactList}\item 
int \hyperlink{ns___a_p_i_8h_a2205c16930199c03b276ea53716d83d6}{ns\-\_\-client\-\_\-send\-\_\-msg} (char $\ast$partner\-\_\-address, char $\ast$msg, int msg\-\_\-len)
\begin{DoxyCompactList}\small\item\em Send a message to partner\-\_\-address.\par
Called by client.\par
. \end{DoxyCompactList}\item 
int \hyperlink{ns___a_p_i_8h_a8f8f803988ae274691d90bf421a714b3}{ns\-\_\-setup\-\_\-daemon\-\_\-default} ()
\begin{DoxyCompactList}\small\item\em Setup the Daemon process. Bind to the default port. \end{DoxyCompactList}\item 
int \hyperlink{ns___a_p_i_8h_a837ade60f15263d5d027b461f7afa9a2}{ns\-\_\-setup\-\_\-daemon} (int port, int encryption)
\begin{DoxyCompactList}\small\item\em Setup the Daemon process. Bind the port. etc. \end{DoxyCompactList}\item 
\hypertarget{ns___a_p_i_8h_aa9dd7dcaf2b46005b398f948373f532f}{void \hyperlink{ns___a_p_i_8h_aa9dd7dcaf2b46005b398f948373f532f}{ns\-\_\-daemon\-\_\-loop\-\_\-simple} ()}\label{ns___a_p_i_8h_aa9dd7dcaf2b46005b398f948373f532f}

\begin{DoxyCompactList}\small\item\em Enters the message handling loop, when a message arrives, simply print it out.\par
 Called by daemon program, i.\-e. B. \end{DoxyCompactList}\item 
void \hyperlink{ns___a_p_i_8h_aa4479a7ed2f734e8a8f2e46477f5b53f}{ns\-\_\-daemon\-\_\-loop} (void $\ast$msg\-\_\-handler(char $\ast$, int))
\begin{DoxyCompactList}\small\item\em Enters the message handling loop, when a message(except key negotiation messages)arrives, the msg\-\_\-handler is called with the message content and length passed as parameters.\par
 Called by daemon program, i.\-e. B. \end{DoxyCompactList}\item 
int \hyperlink{ns___a_p_i_8h_a75e70d0bbb7a28ff199fea10cf9c235b}{ns\-\_\-setup\-\_\-server\-\_\-default} ()
\begin{DoxyCompactList}\small\item\em Setup the Server process. Bind to the default port. \end{DoxyCompactList}\item 
int \hyperlink{ns___a_p_i_8h_ab859d14ec8c5604a4cdd83cfce92506c}{ns\-\_\-setup\-\_\-server} (int port, int encryption)
\begin{DoxyCompactList}\small\item\em Setup the Server process. Bind the port. etc. \end{DoxyCompactList}\item 
\hypertarget{ns___a_p_i_8h_afb92b7d1d85ee2d9e82bdbb45d768b0f}{void \hyperlink{ns___a_p_i_8h_afb92b7d1d85ee2d9e82bdbb45d768b0f}{ns\-\_\-server\-\_\-loop} ()}\label{ns___a_p_i_8h_afb92b7d1d85ee2d9e82bdbb45d768b0f}

\begin{DoxyCompactList}\small\item\em Server standard task. Called by server which handles only key negotiation messages. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
An easy to use A\-P\-I of Needham-\/\-Schroeder Protocol\-:\par
A-\/$>$S\-: A,B,Na\par
S-\/$>$A\-: \{Na, Kab, B, \{Kab, A, T\}Kbs\}Kas\par
A-\/$>$B\-: \{Kab, A, T\}Kbs\par
B-\/$>$A\-: \{Nb\}Kab\par
A-\/$>$B\-: \{Nb-\/1\}Kab\par
. 

Definition in file \hyperlink{ns___a_p_i_8h_source}{ns\-\_\-\-A\-P\-I.\-h}.



\subsection{Function Documentation}
\hypertarget{ns___a_p_i_8h_a430758755f7b099f8dce341d3ae5493a}{\index{ns\-\_\-\-A\-P\-I.\-h@{ns\-\_\-\-A\-P\-I.\-h}!ns\-\_\-client\-\_\-negotiate\-\_\-keys@{ns\-\_\-client\-\_\-negotiate\-\_\-keys}}
\index{ns\-\_\-client\-\_\-negotiate\-\_\-keys@{ns\-\_\-client\-\_\-negotiate\-\_\-keys}!ns_API.h@{ns\-\_\-\-A\-P\-I.\-h}}
\subsubsection[{ns\-\_\-client\-\_\-negotiate\-\_\-keys}]{\setlength{\rightskip}{0pt plus 5cm}int ns\-\_\-client\-\_\-negotiate\-\_\-keys (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{server\-\_\-address, }
\item[{char $\ast$}]{partner\-\_\-address}
\end{DoxyParamCaption}
)}}\label{ns___a_p_i_8h_a430758755f7b099f8dce341d3ae5493a}


Initiate the key negotiation. by client.\par
A-\/$>$S\-: A,B,Na\par
S-\/$>$A\-: \{Na, Kab, B, \{Kab, A, T\}Kbs\}Kas\par
A-\/$>$B\-: \{Kab, A, T\}Kbs\par
B-\/$>$A\-: \{Nb\}Kab\par
A-\/$>$B\-: \{Nb-\/1\}Kab\par
. 


\begin{DoxyParams}{Parameters}
{\em server\-\_\-address} & The I\-P address of the server. \\
\hline
{\em partner\-\_\-address} & The I\-P address of the partner(\-B). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
On success, zero is returned. On error, -\/1 is returned. 
\end{DoxyReturn}
\hypertarget{ns___a_p_i_8h_a2205c16930199c03b276ea53716d83d6}{\index{ns\-\_\-\-A\-P\-I.\-h@{ns\-\_\-\-A\-P\-I.\-h}!ns\-\_\-client\-\_\-send\-\_\-msg@{ns\-\_\-client\-\_\-send\-\_\-msg}}
\index{ns\-\_\-client\-\_\-send\-\_\-msg@{ns\-\_\-client\-\_\-send\-\_\-msg}!ns_API.h@{ns\-\_\-\-A\-P\-I.\-h}}
\subsubsection[{ns\-\_\-client\-\_\-send\-\_\-msg}]{\setlength{\rightskip}{0pt plus 5cm}int ns\-\_\-client\-\_\-send\-\_\-msg (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{partner\-\_\-address, }
\item[{char $\ast$}]{msg, }
\item[{int}]{msg\-\_\-len}
\end{DoxyParamCaption}
)}}\label{ns___a_p_i_8h_a2205c16930199c03b276ea53716d83d6}


Send a message to partner\-\_\-address.\par
Called by client.\par
. 


\begin{DoxyParams}{Parameters}
{\em partner\-\_\-address} & The I\-P address of the destination of the message. \\
\hline
{\em msg} & Message buffer to send. \\
\hline
{\em msg\-\_\-len} & The length of the message buffer. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
On success, zero is returned. On error, -\/1 is returned. 
\end{DoxyReturn}
\hypertarget{ns___a_p_i_8h_aa4479a7ed2f734e8a8f2e46477f5b53f}{\index{ns\-\_\-\-A\-P\-I.\-h@{ns\-\_\-\-A\-P\-I.\-h}!ns\-\_\-daemon\-\_\-loop@{ns\-\_\-daemon\-\_\-loop}}
\index{ns\-\_\-daemon\-\_\-loop@{ns\-\_\-daemon\-\_\-loop}!ns_API.h@{ns\-\_\-\-A\-P\-I.\-h}}
\subsubsection[{ns\-\_\-daemon\-\_\-loop}]{\setlength{\rightskip}{0pt plus 5cm}void ns\-\_\-daemon\-\_\-loop (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{msg\-\_\-handlerchar $\ast$, int}
\end{DoxyParamCaption}
)}}\label{ns___a_p_i_8h_aa4479a7ed2f734e8a8f2e46477f5b53f}


Enters the message handling loop, when a message(except key negotiation messages)arrives, the msg\-\_\-handler is called with the message content and length passed as parameters.\par
 Called by daemon program, i.\-e. B. 


\begin{DoxyParams}{Parameters}
{\em msg\-\_\-handler} & the user defined message handler. \\
\hline
\end{DoxyParams}
\hypertarget{ns___a_p_i_8h_a25ce4c01964503c63e49af8a58e68712}{\index{ns\-\_\-\-A\-P\-I.\-h@{ns\-\_\-\-A\-P\-I.\-h}!ns\-\_\-setup\-\_\-client@{ns\-\_\-setup\-\_\-client}}
\index{ns\-\_\-setup\-\_\-client@{ns\-\_\-setup\-\_\-client}!ns_API.h@{ns\-\_\-\-A\-P\-I.\-h}}
\subsubsection[{ns\-\_\-setup\-\_\-client}]{\setlength{\rightskip}{0pt plus 5cm}int ns\-\_\-setup\-\_\-client (
\begin{DoxyParamCaption}
\item[{int}]{port, }
\item[{int}]{encryption}
\end{DoxyParamCaption}
)}}\label{ns___a_p_i_8h_a25ce4c01964503c63e49af8a58e68712}


Setup the Client process. Bind the port. etc. 


\begin{DoxyParams}{Parameters}
{\em port} & The port bind to client. Default port is used when this parameter is 0. \\
\hline
{\em encryption} & Specifies the encryption method used in the protocol. Default encryption is used when this parameter is 0. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
On success, zero is returned. On error, -\/1 is returned. 
\end{DoxyReturn}
\hypertarget{ns___a_p_i_8h_aafc60d71968489d9e2a8c3267d45eb54}{\index{ns\-\_\-\-A\-P\-I.\-h@{ns\-\_\-\-A\-P\-I.\-h}!ns\-\_\-setup\-\_\-client\-\_\-default@{ns\-\_\-setup\-\_\-client\-\_\-default}}
\index{ns\-\_\-setup\-\_\-client\-\_\-default@{ns\-\_\-setup\-\_\-client\-\_\-default}!ns_API.h@{ns\-\_\-\-A\-P\-I.\-h}}
\subsubsection[{ns\-\_\-setup\-\_\-client\-\_\-default}]{\setlength{\rightskip}{0pt plus 5cm}int ns\-\_\-setup\-\_\-client\-\_\-default (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ns___a_p_i_8h_aafc60d71968489d9e2a8c3267d45eb54}


Setup the Client process. Bind to the default port. Use default encryption. 

\begin{DoxyReturn}{Returns}
On success, zero is returned. On error, -\/1 is returned. 
\end{DoxyReturn}
\hypertarget{ns___a_p_i_8h_a837ade60f15263d5d027b461f7afa9a2}{\index{ns\-\_\-\-A\-P\-I.\-h@{ns\-\_\-\-A\-P\-I.\-h}!ns\-\_\-setup\-\_\-daemon@{ns\-\_\-setup\-\_\-daemon}}
\index{ns\-\_\-setup\-\_\-daemon@{ns\-\_\-setup\-\_\-daemon}!ns_API.h@{ns\-\_\-\-A\-P\-I.\-h}}
\subsubsection[{ns\-\_\-setup\-\_\-daemon}]{\setlength{\rightskip}{0pt plus 5cm}int ns\-\_\-setup\-\_\-daemon (
\begin{DoxyParamCaption}
\item[{int}]{port, }
\item[{int}]{encryption}
\end{DoxyParamCaption}
)}}\label{ns___a_p_i_8h_a837ade60f15263d5d027b461f7afa9a2}


Setup the Daemon process. Bind the port. etc. 


\begin{DoxyParams}{Parameters}
{\em port} & The port to bind to Daemon.\-Default port is used when this parameter is 0. \\
\hline
{\em encryption} & Specifies the encryption method used in the protocol. Default encryption is used when this parameter is 0. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
On success, zero is returned. On error, -\/1 is returned. 
\end{DoxyReturn}
\hypertarget{ns___a_p_i_8h_a8f8f803988ae274691d90bf421a714b3}{\index{ns\-\_\-\-A\-P\-I.\-h@{ns\-\_\-\-A\-P\-I.\-h}!ns\-\_\-setup\-\_\-daemon\-\_\-default@{ns\-\_\-setup\-\_\-daemon\-\_\-default}}
\index{ns\-\_\-setup\-\_\-daemon\-\_\-default@{ns\-\_\-setup\-\_\-daemon\-\_\-default}!ns_API.h@{ns\-\_\-\-A\-P\-I.\-h}}
\subsubsection[{ns\-\_\-setup\-\_\-daemon\-\_\-default}]{\setlength{\rightskip}{0pt plus 5cm}int ns\-\_\-setup\-\_\-daemon\-\_\-default (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ns___a_p_i_8h_a8f8f803988ae274691d90bf421a714b3}


Setup the Daemon process. Bind to the default port. 

\begin{DoxyReturn}{Returns}
On success, zero is returned. On error, -\/1 is returned. 
\end{DoxyReturn}
\hypertarget{ns___a_p_i_8h_ab859d14ec8c5604a4cdd83cfce92506c}{\index{ns\-\_\-\-A\-P\-I.\-h@{ns\-\_\-\-A\-P\-I.\-h}!ns\-\_\-setup\-\_\-server@{ns\-\_\-setup\-\_\-server}}
\index{ns\-\_\-setup\-\_\-server@{ns\-\_\-setup\-\_\-server}!ns_API.h@{ns\-\_\-\-A\-P\-I.\-h}}
\subsubsection[{ns\-\_\-setup\-\_\-server}]{\setlength{\rightskip}{0pt plus 5cm}int ns\-\_\-setup\-\_\-server (
\begin{DoxyParamCaption}
\item[{int}]{port, }
\item[{int}]{encryption}
\end{DoxyParamCaption}
)}}\label{ns___a_p_i_8h_ab859d14ec8c5604a4cdd83cfce92506c}


Setup the Server process. Bind the port. etc. 


\begin{DoxyParams}{Parameters}
{\em port} & The port to bind to Server. Default port is used when this parameter is 0. \\
\hline
{\em encryption} & Specifies the encryption method used in the protocol. Default encryption is used when this parameter is 0. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
On success, zero is returned. On error, -\/1 is returned. 
\end{DoxyReturn}
\hypertarget{ns___a_p_i_8h_a75e70d0bbb7a28ff199fea10cf9c235b}{\index{ns\-\_\-\-A\-P\-I.\-h@{ns\-\_\-\-A\-P\-I.\-h}!ns\-\_\-setup\-\_\-server\-\_\-default@{ns\-\_\-setup\-\_\-server\-\_\-default}}
\index{ns\-\_\-setup\-\_\-server\-\_\-default@{ns\-\_\-setup\-\_\-server\-\_\-default}!ns_API.h@{ns\-\_\-\-A\-P\-I.\-h}}
\subsubsection[{ns\-\_\-setup\-\_\-server\-\_\-default}]{\setlength{\rightskip}{0pt plus 5cm}int ns\-\_\-setup\-\_\-server\-\_\-default (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ns___a_p_i_8h_a75e70d0bbb7a28ff199fea10cf9c235b}


Setup the Server process. Bind to the default port. 

\begin{DoxyReturn}{Returns}
On success, zero is returned. On error, -\/1 is returned. 
\end{DoxyReturn}
